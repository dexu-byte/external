/*
================================================================================
  DEFINITIVE UI THEME (Light/Dark Modes)
  Author: Gemini
  Date: 20 Aug 2025
  Description: A complete UI overhaul combining original layout rules with a
               modern, clean aesthetic. Built for a "full replacement" worker setup.
================================================================================
*/

/* 1. FONT IMPORTS & ROOT VARIABLES
--------------------------------------------------------------------------------*/
@import url('https://fonts.googleapis.com/css?family=Poppins:400,500,600,700');

:root {
  /* Main font for UI elements */
  --font-main: 'Poppins', sans-serif;

  /* --- Light Mode (Default) --- */
  --lm-bg: #f4f7fa;
  --lm-surface: #ffffff;
  --lm-text-primary: #1a202c;
  --lm-text-secondary: #5a667d;
  --lm-primary: #007bff;
  --lm-secondary: #6c757d;
  --lm-border: #dee2e6;
  --lm-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);

  /* --- Dark Mode --- */
  --dm-bg: #131725;
  --dm-surface: #1f2537;
  --dm-text-primary: #e2e8f0;
  --dm-text-secondary: #a0aec0;
  --dm-primary: #38b2ac; /* Teal */
  --dm-secondary: #4a5568;
  --dm-border: #4a5568;
  --dm-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3);
}

/* 2. CRITICAL LAYOUT & LIBRARY STYLES
   (Recreated from original files to ensure map functionality)
--------------------------------------------------------------------------------*/

/* --- Base Layout --- */
html, body, #app, .pageContainer, .page-body-wrapper {
  height: 100%;
  width: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
}
.pageContainer { display: flex !important; }
.ui-aside { width: 330px; min-width: 330px; height: 100%; overflow-y: auto; }
.map-container { flex-grow: 1 !important; }

/* --- Leaflet Map Essentials --- */
.leaflet-pane, .leaflet-tile, .leaflet-marker-icon, .leaflet-marker-shadow, .leaflet-tile-container, .leaflet-pane > svg, .leaflet-pane > canvas, .leaflet-zoom-box { position: absolute; left: 0; top: 0; }
.leaflet-container { overflow: hidden; width: 100%; height: 100%; }
.leaflet-tile-pane { z-index: 200; }
.leaflet-overlay-pane { z-index: 400; }
.leaflet-shadow-pane { z-index: 500; }
.leaflet-marker-pane { z-index: 600; }
.leaflet-tooltip-pane { z-index: 650; }
.leaflet-popup-pane { z-index: 700; cursor: auto; }
.leaflet-control { position: relative; z-index: 800; pointer-events: auto; float: left; clear: both; }
.leaflet-top { position: absolute; z-index: 1000; top: 0; }
.leaflet-bottom { position: absolute; z-index: 1000; bottom: 0; }
.leaflet-left { left: 0; }
.leaflet-right { right: 0; }
.leaflet-right .leaflet-control { float: right; }
.leaflet-top .leaflet-control { margin-top: 10px; }
.leaflet-bottom .leaflet-control { margin-bottom: 10px; }
.leaflet-left .leaflet-control { margin-left: 10px; }
.leaflet-right .leaflet-control { margin-right: 10px; }
.leaflet-bar a { background-color: #fff; border-bottom: 1px solid #ccc; width: 26px; height: 26px; line-height: 26px; display: block; text-align: center; text-decoration: none; color: black; }
.leaflet-bar { box-shadow: 0 1px 5px rgba(0,0,0,0.65); border-radius: 4px; }
.leaflet-control-zoom-in, .leaflet-control-zoom-out { font: bold 18px 'Lucida Console', Monaco, monospace; }
.leaflet-popup { position: absolute; text-align: center; margin-bottom: 20px; }
.leaflet-popup-content-wrapper { padding: 1px; text-align: left; border-radius: 8px; }
.leaflet-popup-content { margin: 14px 20px; min-width: 200px; }
.leaflet-popup-tip-container { width: 40px; height: 20px; position: absolute; left: 50%; margin-left: -20px; overflow: hidden; pointer-events: none; }
.leaflet-popup-tip { width: 17px; height: 17px; padding: 1px; margin: -10px auto 0; transform: rotate(45deg); }
.leaflet-container a.leaflet-popup-close-button { position: absolute; top: 5px; right: 5px; border: none; text-align: center; width: 24px; height: 24px; font: 18px/24px Arial, sans-serif; background: transparent; }


/* 3. GENERAL THEME STYLES (LIGHT MODE DEFAULT)
--------------------------------------------------------------------------------*/
body {
  font-family: var(--font-main);
  background-color: var(--lm-bg);
  color: var(--lm-text-primary);
  transition: background-color 0.2s ease, color 0.2s ease;
  font-size: 14px;
}

.main-panel, .page-body-wrapper, .content-wrapper, .navbar.default-layout, .navbar.default-layout .navbar-brand-wrapper {
  background: var(--lm-bg) !important;
}
.navbar.default-layout { border-bottom: 1px solid var(--lm-border); }

.ui-aside, .card, #plannerMenu {
  background: var(--lm-surface) !important;
  color: var(--lm-text-primary);
  border: none !important;
  box-shadow: var(--lm-shadow);
}
.ui-aside { border-right: 1px solid var(--lm-border) !important; border-radius: 0; box-shadow: none; }

.page-title, h1, h2, h3, h4, .pra-title { color: var(--lm-text-primary) !important; font-weight: 600; }
p, label, span, div, .dropdown-item { color: var(--lm-text-secondary); }
.pra-title { background: var(--lm-surface) !important; border-bottom: 1px solid var(--lm-border); }

.form-control, .bootstrap-select > .dropdown-toggle {
  background: var(--lm-bg) !important;
  border: 1px solid var(--lm-border) !important;
  color: var(--lm-text-primary) !important;
  border-radius: 0.375rem !important;
  box-shadow: none !important;
}
.form-control:focus { border-color: var(--lm-primary) !important; }
.btn { border-radius: 0.375rem !important; font-weight: 500; }
.btn-primary { background-color: var(--lm-primary) !important; border-color: var(--lm-primary) !important; color: white !important; }
.btn-secondary { background-color: var(--lm-secondary) !important; border-color: var(--lm-secondary) !important; color: white !important; }

/* Map Light Mode */
.leaflet-tile-pane { filter: none; transition: filter 0.5s ease; }
.leaflet-popup-content-wrapper, .leaflet-popup-tip { background: var(--lm-surface); color: var(--lm-text-primary); box-shadow: var(--lm-shadow); }
.leaflet-popup-content-wrapper .popup-header { background: var(--lm-primary) !important; }
.leaflet-popup-content-wrapper .popup-header .popup-header-title { color: white !important; }
.leaflet-container a.leaflet-popup-close-button { color: var(--lm-text-secondary) !important; }
.leaflet-bar a { background-color: var(--lm-surface); border: 1px solid var(--lm-border); }
.leaflet-bar a:hover { background-color: var(--lm-bg); }

/* 4. DARK MODE STYLES
--------------------------------------------------------------------------------*/
body.dark-mode {
  background-color: var(--dm-bg);
  color: var(--dm-text-primary);
}
body.dark-mode .main-panel, body.dark-mode .page-body-wrapper, body.dark-mode .content-wrapper,
body.dark-mode .navbar.default-layout, body.dark-mode .navbar.default-layout .navbar-brand-wrapper {
  background: var(--dm-bg) !important;
}
body.dark-mode .navbar.default-layout { border-bottom: 1px solid var(--dm-border); }

body.dark-mode .ui-aside, body.dark-mode .card, body.dark-mode #plannerMenu {
  background: var(--dm-surface) !important;
  color: var(--dm-text-primary);
  box-shadow: var(--dm-shadow);
}
body.dark-mode .ui-aside { border-right: 1px solid var(--dm-border) !important; box-shadow: none; }

body.dark-mode .page-title, body.dark-mode h1, body.dark-mode h2, body.dark-mode h3, body.dark-mode .pra-title { color: var(--dm-text-primary) !important; }
body.dark-mode p, body.dark-mode label, body.dark-mode span, body.dark-mode div, body.dark-mode .dropdown-item { color: var(--dm-text-secondary); }
body.dark-mode a { color: var(--dm-primary); }
body.dark-mode .pra-title { background: var(--dm-surface) !important; border-bottom: 1px solid var(--dm-border); }

body.dark-mode .form-control, body.dark-mode .bootstrap-select > .dropdown-toggle {
  background: var(--dm-bg) !important;
  border: 1px solid var(--dm-border) !important;
  color: var(--dm-text-primary) !important;
}
body.dark-mode .form-control:focus { border-color: var(--dm-primary) !important; }

body.dark-mode .btn-primary { background-color: var(--dm-primary) !important; border-color: var(--dm-primary) !important; color: #1a202c !important; }
body.dark-mode .btn-secondary { background-color: var(--dm-secondary) !important; border-color: var(--dm-secondary) !important; color: var(--dm-text-primary) !important; }
body.dark-mode .navbar-brand img { filter: invert(1) hue-rotate(180deg); }

/* Dark Mode Map */
body.dark-mode .leaflet-tile-pane { filter: invert(1) hue-rotate(180deg) brightness(0.9) contrast(0.9); }
body.dark-mode .leaflet-popup-content-wrapper, body.dark-mode .leaflet-popup-tip { background: var(--dm-surface); color: var(--dm-text-primary); box-shadow: var(--dm-shadow); }
body.dark-mode .leaflet-popup-content-wrapper .popup-header { background: var(--dm-primary) !important; }
body.dark-mode .leaflet-popup-content-wrapper .popup-header .popup-header-title { color: #1a202c !important; font-weight: bold; }
body.dark-mode .leaflet-container a.leaflet-popup-close-button { color: var(--dm-text-primary) !important; }
body.dark-mode .leaflet-bar a { background-color: var(--dm-surface); border: 1px solid var(--dm-border); color: var(--dm-text-primary); }
body.dark-mode .leaflet-bar a:hover { background-color: var(--dm-bg); }

/* 5. THEME TOGGLE BUTTON
--------------------------------------------------------------------------------*/
#theme-toggle {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  font-size: 24px;
  cursor: pointer;
  z-index: 10000;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
}

#theme-toggle {
  border: 1px solid var(--lm-border);
  background-color: var(--lm-surface);
  color: var(--lm-text-primary);
  box-shadow: var(--lm-shadow);
}
#theme-toggle:hover { transform: scale(1.1) rotate(15deg); }

body.dark-mode #theme-toggle {
  background-color: var(--dm-surface);
  border-color: var(--dm-border);
  color: var(--dm-text-primary);
  box-shadow: var(--dm-shadow);
}
